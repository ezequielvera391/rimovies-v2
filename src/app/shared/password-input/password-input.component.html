<div class="flex flex-col">
  <p *ngIf="label" class="text label" data-testid="password-label">{{ label }}</p>

  <!-- Password -->
  <div class="input-wrapper">
    <input class="input" [ngClass]="{ 'input--invalid': hasError }" [type]="showPassword ? 'text' : 'password'"
      [attr.placeholder]="placeholder" [attr.aria-label]="ariaLabel" [attr.aria-invalid]="hasError"
      [attr.aria-describedby]="errorId" title="password" [value]="value" (input)="onInput($event)" (blur)="handleBlur()"
      data-testid="password-input" />
    <button type="button" class="input__icon input__icon--white flex" (click)="togglePasswordVisibility()"
      [attr.aria-pressed]="showPassword" [attr.aria-label]="showPassword ? 'Hide password' : 'Show password'"
      data-testid="toggle-button">
      <img [src]="imgIcon" alt="Toggle visibility" data-testid="toggle-icon">
    </button>
  </div>

  <!-- Confirm (solo en registro) -->
  <div *ngIf="confirm" class="input-wrapper">
    <input class="input" [ngClass]="{ 'input--invalid': hasError }" [type]="showConfirm ? 'text' : 'password'"
      placeholder="Confirm password" aria-label="Confirm password" [attr.aria-invalid]="hasError"
      [attr.aria-describedby]="errorId" title="confirm-password" [value]="confirmValue" (input)="onInputConfirm($event)"
      (blur)="handleBlurConfirm()" data-testid="password-confirm-input" />
    <button type="button" class="input__icon input__icon--white flex" (click)="toggleConfirmVisibility()"
      [attr.aria-pressed]="showConfirm" [attr.aria-label]="showConfirm ? 'Hide password' : 'Show password'"
      data-testid="toggle-confirm-button">
      <img [src]="showConfirm ? 'assets/images/icons/visibility_on.svg' : 'assets/images/icons/visibility_off.svg'"
      alt="Toggle visibility">
    </button>
  </div>

  <!-- Slot de error -->
  <div class="input-error-slot" [id]="errorId" aria-live="polite">
    <span class="input-error" role="alert" *ngIf="hasError">
      {{ currentErrorMessage }}
    </span>
  </div>
</div>
